<?xml version="1.0" encoding="utf-8" ?>
<!--

' // ***************************************************************************
' // 
' // Copyright (c) Microsoft Corporation.  All rights reserved.
' // 
' // Microsoft Deployment Toolkit Solution Accelerator
' //
' // File:      DeployWiz_Definition_ENU.wsf
' // 
' // Version:   5.0.1641.0
' // 
' // Purpose:   Main Client Deployment Wizard Defintion File
' // 
' // ***************************************************************************

-->

<Wizard>
	<Global>

		<CustomStatement><![CDATA[ document.title =  "Windows Deployment Wizard" ]]> </CustomStatement>
		<CustomStatement><![CDATA[ window.resizeTo 700,500 ]]> </CustomStatement>

		<Initialization>DeployWiz_Initialization.vbs</Initialization>
		<Validation>DeployWiz_Validation.vbs</Validation>

	</Global>

	<!-- ************************************************************** -->
	<!-- ************************************************************** -->

	<Pane id="DeployRoot">

		<Condition><![CDATA[Left(ucase(Property("DeployRoot")),3)="X:\" or Property("DeployRoot") = "" ]]></Condition>
		<Initialization><![CDATA[ InitializeDeployRoot ]]> </Initialization>
		<Validation><![CDATA[ ValidateDeployRoot ]]> </Validation>

		<Body>
		<![CDATA[

           <!-- Use the H1 Style for titles at the top of the page -->
           <H1>Welcome to the Windows Deployment Wizard!<H1>

           <p>Before this wizard can continue, it will need to know the path of a Deployment Share.</p>
           <span id=DisplayLocal>
              <table width=95% >
                <tr >
                  <td align=right>
                    <input type=radio name="ConnectionType" id="RadioCT1" checked accesskey=L language=vbscript  onclick=DisplayValidateDeployRoot>
                  </td>
                  <td>
                    <label class=Larger for=RadioCT1 language=vbscript >Select my deployment share based on my site <u class=larger>L</u>ocale:</label>
                  </td>
                </tr>
                <tr>
                  <td width=0px>
                  </td>
                  <td>
                      <u>S</u>ite:<br/>
                      <select id=SiteList class=WideEdit datasrc="#Sites" datafld="Description" accesskey=s onchange=ChangeServerFromSite>
                          <option value="" >Select a Site:</option>
                      </select>
                      <div><label class=ErrMsg for=SiteList>* Required (MISSING)</label>&nbsp;</div>
                  </td>
                </tr>
                <tr>
                  <td colspan=2> &nbsp;</td>
                </tr>
              <tr>
                <td align=right>
                  <input type=radio name="ConnectionType" id="RadioCT2" accesskey=M language=vbscript  onclick=DisplayValidateDeployRoot>
                </td>
                <td>
                  <label class=Larger for=RadioCT2 language=vbscript ><u class=larger>M</u>anually specify the server location:</label>
                </td>
              </tr>
              </table>
            </span>

            <table width=95%>
              <tr>
                <td width=0px>
                </td>
                <td>
                  <span>Deployment Share: (format: "\\Server\share"   or   "\\server" </span>
                  <input type=text id=DeployRoot name=DeployRoot class=wideedit />
                  <div><label class=ErrMsg for=DeployRoot>* Required (MISSING)</label>&nbsp;</div>
                </td>
              </tr>

<!--
              <tr>
                <td colspan=2> &nbsp;</td>
              </tr>

              <tr>
                <td align=right>
                  <input type=checkbox name=DisplayCustomWizard id=UseCustom accesskey=A onchange=DisplayValidateDeployRoot onpropertychange=DisplayValidateDeployRoot />
                </td>
                <td>
                  <label for=UseCustom> Display <u>A</u>dvanced settings during wizard.</label>
                </td>
              </tr>
-->
            </table>

		]]>

		</Body>

	</Pane>


	<Pane id="SelectTaskSequence">
		<Condition><![CDATA[UCASE(Property("SkipTaskSequence"))<>"YES" ]]></Condition>
		<Body>
			<![CDATA[
				<H1>Select a task sequence to execute on this computer.</H1>
				<p>The following task sequences are available. &nbsp;&nbsp;&nbsp;<label class=ErrMsg id=Bad_OSGUID>Bad Task Sequence Item (Missing OS)</label></p> 

				<div class=TreeList id=TSListBox style="height: expression( GetDynamicListBoxSize(this) );">
<label class=errmsg style="display: inline;" >No task sequences are available (TaskSequences.xml does not exist, is empty, or is inaccessible)</label>
					<!-- List goes here -->

				</div>
				
			]]>
		</Body>
		<Initialization><![CDATA[InitializeTSList]]></Initialization>
		<Validation><![CDATA[ValidateTSList]]></Validation>
	</Pane>


	<Pane id="ProductKey_Vista">
		<Condition><![CDATA[UCASE(Property("SkipProductKey"))<>"YES" and Property("DeploymentType")<>"REPLACE" and Property("DeploymentType")<>"CUSTOM" and Property("DeploymentType")<>"StateRestore" and Left(Property("ImageBuild"), 1) = "6" ]]></Condition>
		<Body>
		<![CDATA[
		<H1>Specify the product key needed to install this operating system.</H1>
		<table>
			<tr>
				<td>
					<input type=radio name="SelectKey" id="PKRadio1" checked language=vbscript onclick=ValidateProductKey AccessKey=O>
				</td>
				<td>
					<Label class="Larger" for=PKRadio1 language=vbscript >N<u class=larger>o</u> product key is required.</Label>
				</td>
			</tr>
			<tr>
				<td></td>
				<td>
					<div>The operating system being deployed does not require a product key because it will be activated using the Key Management Service.</div>
				</td>
			</tr>

			<tr><td colspan=2>&nbsp;</td></tr>

			<tr>
				<td>
					<input type=radio name="SelectKey" id="PKRadio2" language=vbscript onclick=ValidateProductKey AccessKey=M>
				</td>
				<td>
					<Label class="Larger" for=PKRadio2 language=vbscript >Activate the machine with a <u class=larger>m</u>ultiple activation key (MAK).</Label>
				</td>
			</tr>
			<tr>
				<td></td>
				<td>
					<div>The operating system being deployed will not be able to activate via the Key Management Service, so a multiple activation key will activate
					the computer over the internet.</div>
					<br>
					<div>Multiple <u>a</u>ctivation key: <label class=ErrMsg id=OverrideBlank>* Required (MISSING)</label><label class=ErrMsg id=OverrideInvalid>* Invalid product key</label></div>
					<input type=text id="locOverrideProductKey" size=50 disabled language=vbscript onpropertychange=ValidateProductKey onblur=AssignProductKey AccessKey=A>
				</td>
			</tr>

			<tr><td colspan=2>&nbsp;</td></tr>

			<tr>
				<td>
					<input type=radio name="SelectKey" id="PKRadio3" language=vbscript onclick=ValidateProductKey AccessKey=U>
				</td>
				<td>
					<Label class="Larger" for=PKRadio3 language=vbscript ><u class=larger>U</u>se a specific product key.</Label>
				</td>
			</tr>
			<tr>
				<td></td>
				<td>
					<div>This computer requires a specific license key for installation or retail activation.</div>
					<br>
					<div>P<u>r</u>oduct key: <label class=ErrMsg id=PKBlank>* Required (MISSING)</label><label class=ErrMsg id=PKInvalid>* Invalid product key</label></div>
					<input type=text id="locProductKey" size=50 disabled language=vbscript onpropertychange=ValidateProductKey onblur=AssignProductKey AccessKey=R>
				</td>
			</tr>

		</table>

		<input type=hidden id=pKey name=ProductKey>
		<input type=hidden id=oKey name=OverrideProductKey>

		]]>
		</Body>
		<Initialization><![CDATA[InitializeProductKey]]></Initialization>
		<Validation><![CDATA[ValidateProductKey]]></Validation>
	</Pane>


	<Pane id="DeploymentType">
        <Condition><![CDATA[UCase(Property("SkipDeploymentType"))<>"YES" and Property("DeploymentType")<>"NEWCOMPUTER" or Property("DeploymentType")=""]]></Condition>
        <Condition><![CDATA[ FindTaskSequenceStep( "//step[@type='BDD_InstallOS']", "" ) ]]></Condition>
        <Initialization><![CDATA[ InitializeDeploymentType ]]> </Initialization>
        <Validation><![CDATA[ ValidateDeploymentType ]]> </Validation>
        <Body>
      <![CDATA[
<H1>Choose a migration type.</H1>
<table>
	<tr>
		<td>
			<input type=radio name="DeploymentType" id="DTRadio1" checked value="REFRESH" accesskey=f language=vbscript >
		</td>
		<td>
    		<label class=Larger for=DTRadio1 language=vbscript >Re<u class=larger>f</u>resh this computer.</label>
		</td>
	</tr>
	<tr>
		<td></td>
		<td>
			<p>Save all configuration information, remove the existing operating system, and install a new operating system.</p>
    	</td>
	</tr>
	<tr><td colspan=2>&nbsp;</td></tr>
	<tr>
		<td>
			<input type=radio name="DeploymentType" id="DTRadio2" value="UPGRADE" accesskey=u language=vbscript >
		</td>
		<td>
	    	<label class=Larger for=DTRadio2 language=vbscript ><u class=larger>U</u>pgrade this computer.</label>
		</td>
	</tr>
	<tr>
		<td></td>
		<td>
			<p>Preserve existing applications and configuration information, upgrading the existing operating system.</p>
    	</td>
	</tr>
	<tr><td colspan=2>&nbsp;</td></tr>
</table>

			]]>
		</Body>

  </Pane>
	
	
  <Pane id="DestinationDisk">
    <Condition><![CDATA[UCASE(Property("SkipDestinationDisk")) <> "YES" and (Property("DeploymentType")="NEWCOMPUTER" or Property("DeploymentType")="REFRESH")]]></Condition>
    <Condition><![CDATA[Left(Property("ImageBuild"),1)>="6"]]></Condition>
    <Condition><![CDATA[CheckforDisk <> TRUE]]></Condition>

    <Body>
		<![CDATA[
    <H1>Configure the Target Partition.</H1>
	
	
	<p>On Which Disk and Partition do you want to deploy the Operating System? </p>
	
<table width=90% >
	<tr>
		<td>
			Destination Disk: 
		</td>
		<td>
			<SELECT NAME="DestinationDisk" ></SELECT>
			<label class=ErrMsg id=DiskReq>* Required (MISSING)</label>
			<label class=ErrMsg id=InvalidDisk>The DestinationDisk variable provided is invalid.</label>
		</td>
	</tr>
	<tr>
		<td colspan=2>
			&nbsp;
		</td>
	<tr>
		<td>
			Destination Partition: 
		</td>
		<td>
			<SELECT NAME="DestinationPartition"></SELECT>
			<label class=ErrMsg id=DestinationDiskReq>* Required (MISSING)</label>
			<label class=ErrMsg id=Invalidpartition>When performing a Refresh deployment the Partition specified must be the same as the current OS partition</label>
		</td>
	</tr>
</table>


]]></Body>

    <Initialization>InitializeDestinationDisk</Initialization>
    <Validation>ValidateDestinationDisk</Validation>
  </Pane>


	<Pane id="ComputerName">
		<Condition><![CDATA[UCase(Property("SkipComputerName"))<>"YES" and Property("DeploymentType")<>"REPLACE" and Property("DeploymentType")<>"UPGRADE" and Property("DeploymentType")<>"CUSTOM" and Property("DeploymentType") <> "StateRestore"]]></Condition>
		<Initialization><![CDATA[InitializeComputerName]]> </Initialization>
		<Body>
		<![CDATA[

    <H1>Configure the computer name.</H1>
    <span style="width: 95%;">

        <p>Choose a name for your PC that will help you identify it on your network, if you have one. Each computer on your network must have a unique name.</p>
        <P>You can name your computer based on its owner or location, for example "DAVID" or "XYZLAB123." In order
        for your computer to appear on a network, its name cannot be longer than 15 characters or contain any
        spaces or characters aside from the numbers 0-9, the letters A-Z and a-z, and hyphens.</P>

        <p><span class="Larger">Computer n<u class=larger>a</u>me:</span>
        <input type=text id="OSDComputerName" name=OSDComputerName size=15 language=vbscript onpropertychange=ValidateComputerName AccessKey=A /></p>

        <p>&nbsp;
          <label class=ErrMsg for=OSDComputerName>* Required (MISSING)</label>
          <label class=ErrMsg id=InvalidChar>Letters, Numbers & Dashes only!</label>
          <label class=ErrMsg id=TooLong>Maximum of 15 characters!</label>
        </p>

        <!--  Computer Description Format -->
        <!--

        <p>You can also give your computer a friendly description. Unlike the computer
        name, the computer description may contain spaces and other special characters. "Frank Kim's Test machine" and
        "E-Mail Server #23, Miami Regional Office, Rm. 2305." are examples of computer descriptions.</p>

        <p><span class="Larger">Computer <u class=larger>d</u>escription:</span><br/>
        <input type=text id="Description" name=ComputerDescription size=60 language=vbscript onpropertychange=ValidateComputerName AccessKey=d /></p>
        -->

    </span>

		]]>
		</Body>
		<Validation><![CDATA[ValidateComputerName]]></Validation>
	</Pane>

	<Pane id="DomainMembership">
		<Condition><![CDATA[ PrePopulateDomainMembership ]]></Condition>
		<Condition><![CDATA[UCase(Property("SkipDomainMembership"))<>"YES" and Property("DeploymentType")<>"REPLACE" and Property("DeploymentType")<>"UPGRADE" and Property("DeploymentType")<>"CUSTOM" and Property("DeploymentType") <> "StateRestore" ]]></Condition>
		<Condition><![CDATA[ SkipDomainMembershipIfUpgrade ]]></Condition>
		<Body>
		<![CDATA[
<H1>Join the computer to a domain or workgroup.</H1>
<span id="DisplayCaptureWarning" >Note: Workgroup membership must be selected if an image capture is desired.<P></span>
<table width=90% >
	<tr>
		<td width=5%>
			<input type=radio name="JDRadio" id="JDRadio1" checked language=vbscript onclick=ValidateDomainMembership accesskey=d>
		</td>
		<td colspan="3">
		    <label class=Larger for=JDRadio1>Join a <u class=larger>d</u>omain.</label>
		</td>
	</tr>
	<tr>
		<td colspan=2></td>
		<td width=25%>
			Dom<u>a</u>in:
		</td>
		<td>
			<input type=text id=joindomain name=JoinDomain size=30 language=vbscript onpropertychange=ValidateDomainMembership accesskey=a>
			<label class=ErrMsg for=joindomain>* Required (MISSING)</label>
		</td>
	</tr>

	<tr><td colspan="4">&nbsp;</td></tr>

	<tr>
		<td colspan=2></td>
		<td colspan=2>
			<p>Credentials to use to join the domain:</p>
		</td>
	</tr>

	<tr>
		<td colspan="2"></td>
		<td>
			User Na<u>m</u>e:
		</td>
		<td>
			<input type=text id=username Name="DomainAdmin" size=25 language=vbscript onpropertychange=ValidateDomainMembership accesskey=m>
			<label class=ErrMsg for=username>* Required (MISSING)</label>
		</td>
	</tr>
	<tr>
		<td colspan="2"></td>
	        <td>
			<u>P</u>assword:
		</td>
		<td>
			<input type=password id=password Name="DomainAdminPassword" size=25 language=vbscript onpropertychange=ValidateDomainMembership AccessKey=p>
			<label class=ErrMsg for=password>* Required (MISSING)</label>
		</td>
	</tr>
	<tr>
		<td colspan="2"></td>
	        <td>
			Doma<u>i</u>n:
		</td>
		<td>
			<input type=text Name="DomainAdminDomain" id=userdomain size=25 language=vbscript onpropertychange=ValidateDomainMembership AccessKey=i>
			<label class=ErrMsg for=userdomain>* Required (MISSING)</label>
		</td>
	</tr>

	<tr><td colspan="4"><label class=ErrMsg id=InvalidCredentials>* Invalid credentials</label></td></tr>

	<tr>
		<td colspan=2></td>
		<td>
			<u>O</u>rganizational Unit:
		</td>
		<td>
			<input type=text id=MachineObjectOU name=MachineObjectOU style="width: 75%;" language=vbscript onpropertychange=ValidateDomainMembership accesskey=O>
			<input type="button" id=MachineObjectOUOptionalBtn hidefocus="1" value="&#9660;" style="height:23; width:16; font-family: helvetica; font-size: 7pt; display: none;" onclick="JavaScript:HideUnHideComboBox();"> (Optional) <Br>

			<div id="PopupBox" style="position:absolute; display:none; z-index:10000; width: 75%;" >

				<select size="6" id="MachineObjectOUOptional" style="width: 100%; border-style: none"
				 onchange="JavaScript:MachineObjectOU.value = this.value;"
				 onclick="javascript:HideUnHideComboBox();">
				</select>

			</div>

		</td>
	</tr>

    </div>

	<tr><td colspan="4">&nbsp;</td></tr>

	<tr>
		<td>
			<input type=radio name="JDRadio" id="JDRadio2" language=vbscript onclick=ValidateDomainMembership accesskey=W>
		</td>
		<td colspan="3">
		    <label class=Larger for=JDRadio2>Join a <u class=larger>w</u>orkgroup.</label>
		</td>
	</tr>
	<tr>
		<td colspan="2"></td>
		<td>
			<p>Wor<u>k</u>group:
		</td>
		<td>
			<input type=text id="Workgroup" name=JoinWorkgroup size=30 onpropertychange=javascript:ValidateDomainMembership();  AccessKey=k>
			<label class=ErrMsg for=Workgroup>* Required (MISSING)</label>
		</td>
	</tr>
</table>
		]]>
		</Body>

		<Initialization><![CDATA[InitializeDomainMembership]]></Initialization>
		<Validation><![CDATA[ValidateDomainMembership]]></Validation>
	</Pane>


	<Pane id="UserData">
		<Condition><![CDATA[(Property("DeploymentType") = "REFRESH" or Property("DeploymentType") = "REPLACE") and UCase(Property("SkipUserData"))<>"YES" and Property("DeploymentType") <> "StateRestore"]]></Condition>
		<Condition><![CDATA[ Instr(1, oEnvironment.Item("ImageFlags"), "SERVER", 1) = 0  ]]></Condition>
		<Condition><![CDATA[ ucase(oEnvironment.Item("IsServerOS")) <> "TRUE" ]]></Condition>
		<Condition><![CDATA[ FindTaskSequenceStep("//step[@name='Capture User State']", "ZTIUserState.wsf" ) ]]></Condition>
		<Body>
         <![CDATA[
<H1>Specify where to save your data and settings.</H1>
<table>
	<tr>
		<td>
			<input type=radio name="UserDataLocation" id="UDRadio1"  value="AUTO" language=vbscript onclick=ValidateUserDataLocation  AccessKey=A>
		</td>
		<td>
			<Label class="Larger" for=UDRadio1 language=vbscript ><u class=larger>A</u>utomatically determine the location.</Label>
		</td>
	</tr>
	<tr>
		<td></td>
		<td>
			<div>Let the system determine the best location based on available disk space.</div>
			<br>
			<input type=checkbox id="AllowLocal" checked onclick="javascript:UDRadio1.value= this.checked?'AUTO':'NETWORK';" AccessKey=L>
			<Label for=AllowLocal>Allow data and settings to be stored <u>l</u>ocally when possible.</Label>
		</td>
	</tr>

	<tr><td colspan=2>&nbsp;</td></tr>

	<tr>
		<td>
			<input type=radio name="UserDataLocation" id="UDRadio2" Value="SpecifyLocation" language=vbscript onclick=ValidateUserDataLocation  AccessKey=S>
		</td>
		<td>
			<Label class="Larger" for=UDRadio2 language=vbscript ><u class=larger>S</u>pecify a location.</Label>
		</td>
	</tr>
	<tr>
		<td></td>
		<td>
			<div>Save all configuration information for later restoration.</div>
			<br>
			<div>L<u>o</u>cation:  <label class=ErrMsg for=DataPath>* Required (MISSING)</label><label class=ErrMsg id=InvalidPath>* Invalid local path!</label></div>
			<input type=text id="DataPath" size=65 disabled language=vbscript onpropertychange=ValidateUserDataLocation AccessKey=O>
			<input type="button" id="DataPathBrowse" onclick="javascript:DataPath.value = BrowseForFolder(DataPath.value);" Value="Browse" disabled />
		</td>
	</tr>

	<tr><td colspan=2>&nbsp;</td></tr>

	<tr>
		<td>
			<input type=radio name="UserDataLocation" id="UDRadio3" checked value="NONE" language=vbscript onclick=ValidateUserDataLocation  AccessKey=V>
		</td>
		<td>
			<Label class="Larger" for=UDRadio3 language=vbscript >Do not sa<u class=larger>v</u>e data and settings.</Label>
		</td>
	</tr>
	<tr>
		<td></td>
		<td>
			<p>All user data and settings will be lost.</p>
		</td>
	</tr>
</table>
		]]>
		</Body>
		<Initialization><![CDATA[InitializeUserDataLocation]]></Initialization>
		<Validation><![CDATA[ValidateUserDataLocation]]></Validation>
	</Pane>


	<Pane id="UserDataRestore">
		<Condition><![CDATA[UCase(Property("SkipUserData"))<>"YES" and (Property("DeploymentType")="NEWCOMPUTER" or Property("DeploymentType") = "StateRestore") and Property("DeploymentType")<>"CUSTOM" ]]></Condition>
		<Condition><![CDATA[ Instr(1, oEnvironment.Item("ImageFlags"), "SERVER", 1) = 0  ]]></Condition>
		<Condition><![CDATA[ ucase(oEnvironment.Item("IsServerOS")) <> "TRUE" ]]></Condition>
		<Condition><![CDATA[ FindTaskSequenceStep("//step[@name='Restore User State']", "ZTIUserState.wsf" ) ]]></Condition>

		<Body>
         <![CDATA[
<H1>Specify whether to restore user data.</H1>
<table>

	<tr>
		<td>
			<input type=radio name="UserDataLocation" id="UDRadio1" checked value="NONE" language=vbscript onclick=ValidateUserDataRestoreLocation  AccessKey=r>
		</td>
		<td>
			<Label class="Larger" for=UDRadio1 language=vbscript >Do not <u class=larger>r</u>estore user data and settings.</Label>
		</td>
	</tr>
	<tr>
		<td></td>
		<td>
			<p>This is not a replacement computer, so there are no user data and settings to restore.</p>
		</td>
	</tr>


	<tr><td colspan=2>&nbsp;</td></tr>

	<tr>
		<td>
			<input type=radio name="UserDataLocation" id="UDRadio2" Value="NETWORK" language=vbscript onclick=ValidateUserDataRestoreLocation  AccessKey=S>
		</td>
		<td>
			<Label class="Larger" for=UDRadio2 language=vbscript ><u class=larger>S</u>pecify a location.</Label>
		</td>
	</tr>
	<tr>
		<td></td>
		<td>
			<div>Restore user data and settings from a network location created from a different machine.</div>
			<br>
			<div>L<u>o</u>cation:</div>
			<input type=text id="StatePath" name="StatePath" size=65 disabled language=vbscript AccessKey=O>
			<input type="button" id="StatePathBrowse" style="display: none;" onclick="javascript:StatePath.value = BrowseForFolder(StatePath.value);" Value="Browse" disabled /><br/>(Full network path to previously saved USMT data files).<br/>
			<div><label class=ErrMsg for=StatePath>* Required (MISSING)</label>  <label class=ErrMsg id=InvalidPath>* Invalid path!</label><br/></div>
		</td>
	</tr>

</table>
		]]>
		</Body>
 		<Initialization><![CDATA[InitializeUserDataRestoreLocation]]></Initialization>
 		<Validation><![CDATA[ValidateUserDataRestoreLocation]]></Validation>
	</Pane>


	<Pane id="ComputerBackup">
		<Condition><![CDATA[Property("DeploymentType") <> "UPGRADE" and Property("DeploymentType") <> "NEWCOMPUTER" and Property("DeploymentType") <> "CUSTOM" and Property("DeploymentType") <> "STATERESTORE" and (Property("DeploymentType") = "REFRESH" or Property("DeploymentType") = "REPLACE") and UCase(Property("SkipComputerBackup"))<>"YES"]]></Condition>

		<Body>
  <![CDATA[
<H1>Specify where to save a complete computer backup.</H1>
<table>
	<tr>
		<td>
			<input type=radio name="ComputerBackupLocation" id="CBRadio1" value="AUTO" language=vbscript onclick=ValidateComputerBackupLocation  AccessKey=A>
		</td>
		<td>
			<Label class="Larger" for=CBRadio1 language=vbscript ><u class=larger>A</u>utomatically determine the location.</Label>
		</td>
	</tr>
	<tr>
		<td></td>
		<td>
			<div>Let the system determine the best location based on available disk space.</div>
			<br>
			<input type=checkbox id="AllowLocal" checked language=vbscript onclick="javascript:CBRadio1.value= this.checked?'AUTO':'NETWORK';" AccessKey=L>
			<Label for=AllowLocal>Allow the computer backup to be stored <u>l</u>ocally when possible.</Label>
		</td>
	</tr>

	<tr><td colspan=2>&nbsp;</td></tr>

	<tr>
		<td>
			<input type=radio name="ComputerBackupLocation" id="CBRadio2" Value="SpecifyLocation" language=vbscript onclick=ValidateComputerBackupLocation  AccessKey=S>
		</td>
		<td>
			<Label class="Larger" for=CBRadio2 language=vbscript ><u class=larger>S</u>pecify a location.</Label>
		</td>
	</tr>
	<tr>
		<td></td>
		<td>
			<div>Save the computer backup to the specified location.</div>
			<br>
			<div>L<u>o</u>cation: <label class=ErrMsg for=DataPath>* Required (MISSING)</label></div>
			<input type=text id="DataPath" size=65 disabled language=vbscript onpropertychange=ValidateComputerBackupLocation AccessKey=O>
			<input type="button" id="DataPathBrowse" language=vbscript onclick="javascript:DataPath.value = BrowseForFolder(DataPath.value);" Value="Browse" disabled />
		</td>
	</tr>

	<tr><td colspan=2>&nbsp;</td></tr>

	<tr>
		<td>
			<input type=radio name="ComputerBackupLocation" id="CBRadio3" checked value="NONE" language=vbscript onclick=ValidateComputerBackupLocation  AccessKey=K>
		</td>
		<td>
			<Label class="Larger" for=CBRadio3 language=vbscript >Do not bac<u class=larger>k</u> up the existing computer.</Label>
		</td>
	</tr>
	<tr>
		<td></td>
		<td>
			<p>No backup should be performed.</p>
		</td>
	</tr>
</table>
		]]>
		</Body>
		<Initialization><![CDATA[InitializeComputerBackupLocation]]></Initialization>
		<Validation><![CDATA[ValidateComputerBackupLocation]]></Validation>
	</Pane>



	<Pane id="ProductKey_NT">
		<Condition><![CDATA[UCASE(Property("SkipProductKey"))<>"YES" and Property("DeploymentType")<>"REPLACE" and Property("DeploymentType")<>"CUSTOM" and Left(Property("ImageBuild"), 1) < "6" ]]></Condition>
		<Body>
		<![CDATA[
		<H1>Specify the product key needed to install this operating system.</H1>

		<p>This computer requires a specific license key for installation or retail activation.</p>
		<div>P<u>r</u>oduct key: <label class=ErrMsg id=PKBlank>* Required (MISSING)</label><label class=ErrMsg id=PKInvalid>* Invalid product key</label></div>
		<input type=text id="locProductKey" size=50 disabled language=vbscript onpropertychange=ValidateProductKey onblur=AssignProductKey AccessKey=R>

		<input type=hidden id=pKey name=ProductKey>
		<input type=hidden id=oKey name=OverrideProductKey>

		]]>
		</Body>
		<Initialization><![CDATA[InitializeProductKey]]></Initialization>
		<Validation><![CDATA[ValidateProductKey]]></Validation>
	</Pane>


	<Pane id="SelectLanguagePack">

		<Condition><![CDATA[  ucase(Property("SkipPackageDisplay")) <> "YES" and Property("DeploymentType")<>"REPLACE" and Property("DeploymentType")<>"CUSTOM" and Left(Property("ImageBuild"), 1) = "6" ]]> </Condition>
		<Condition><![CDATA[  CanDisplayPackageDialogBox  ]]> </Condition>
		<Condition><![CDATA[  FindTaskSequenceStep("//step[@type='BDD_InstallUpdatesOffline' and @name='Apply Patches']", "ZTIPatches.wsf" )  ]]> </Condition>
		<Initialization><![CDATA[ LanguagePack_Initialization  ]]> </Initialization>

		<!-- All Content here is displayed to the body of the window. -->
		<Body>
		<![CDATA[

           <!-- Use the H1 Style for titles at the top of the page -->
           <H1>Packages</H1>

				<div class=TreeList id=PackagesListBox style="height: expression( GetDynamicListBoxSize(this) );">
					

					<!-- List goes here -->

				</div>
				<input type=hidden Name=LanguagePacks disabled value="" />
				<input type=hidden Name=LanguagePacks disabled value="" />

  
        ]]>

		</Body>
	</Pane>

	<Pane id="SelectLanguageUI">

		<!-- Skip if using the default! -->
		<Condition>
			<![CDATA[  ucase(Property("SkipLocaleSelection")) <> "YES" and Property("DeploymentType")<>"REPLACE" and Property("DeploymentType")<>"CUSTOM" and Property("DeploymentType") <> "UPGRADE" and Property("DeploymentType") <> "StateRestore" and Left(Property("ImageBuild"), 1) = "6" ]]> </Condition>
		<Initialization><![CDATA[ Locale_Initialization ]]> </Initialization>
		<Validation><![CDATA[  Locale_Validation ]]></Validation>

		<Body>
			<![CDATA[

			<!-- Use the H1 Style for titles at the top of the page -->
			<H1>Language and other preferences<H1>

			<p>Language to install: <label class=ErrMsg id=UILanguage_Err>* Required (MISSING)</label></br>
			<SELECT NAME="UILanguage" class=WideEdit language="vbscript" onchange="SetNewLanguage" >
			</SELECT>
			</p>

			<p>Time and currency format (Locale): <label class=ErrMsg id=UserLocale_Err>* Required (MISSING)</label></br>
			<SELECT NAME="UserLocale_Edit" class=WideEdit language="vbscript" onchange="SetNewLocale" >
			</SELECT>
			</p>

			<p>Keyboard layout: <label class=ErrMsg id=KeyboardLocale_Err>* Required (MISSING)</label></br>
			<SELECT NAME="KeyboardLocale_Edit" class=WideEdit>
				<option value="0000041c">Albanian</option>
				<option value="00000401">Arabic (101)</option>
				<option value="00010401">Arabic (102)</option>
				<option value="00020401">Arabic (102) AZERTY</option>
				<option value="0000042b">Armenian Eastern</option>
				<option value="0001042b">Armenian Western</option>
				<option value="0000044d">ASSAMESE - INSCRIPT</option>
				<option value="0000082c">Azerbaijani Cyrillic</option>
				<option value="0000042c">Azerbaijani Latin</option>
				<option value="0000046d">Bashkir</option>
				<option value="00000423">Belarusian</option>
				<option value="0001080c">Belgian (Comma)</option>
				<option value="00000813">Belgian (Period)</option>
				<option value="0000080c">Belgian French</option>
				<option value="00000445">Bangla</option>
				<option value="00020445">Bangla - INSCRIPT</option>
				<option value="00010445">Bangla - INSCRIPT (Legacy)</option>
				<option value="0000201a">Bosnian (Cyrillic)</option>
				<option value="00030402">Bulgarian</option>
				<option value="00010402">Bulgarian (Latin)</option>
				<option value="00020402">Bulgarian (phonetic layout)</option>
				<option value="00040402">Bulgarian (phonetic traditional)</option>
				<option value="00001009">Canadian French</option>
				<option value="00000c0c">Canadian French (Legacy)</option>
				<option value="00011009">Canadian Multilingual Standard</option>
				<option value="00000804">Chinese (Simplified) - US Keyboard</option>
				<option value="00000404">Chinese (Traditional) - US Keyboard</option>
				<option value="00001404">Chinese (Traditional Macao S.A.R.) US Keyboard</option>
				<option value="00001004">Chinese (Simplified, Singapore) - US keyboard</option>
				<option value="0000041a">Croatian</option>
				<option value="00000405">Czech</option>
				<option value="00010405">Czech (QWERTY)</option>
				<option value="00020405">Czech Programmers</option>
				<option value="00000406">Danish</option>
				<option value="00000439">Devanagari-INSCRIPT</option>
				<option value="00000465">Divehi Phonetic</option>
				<option value="00010465">Divehi Typewriter</option>
				<option value="00000413">Dutch</option>
				<option value="00000425">Estonian</option>
				<option value="00000438">Faeroese</option>
				<option value="0000040b">Finnish</option>
				<option value="0001083b">Finnish with Sami</option>
				<option value="0000040c">French</option>
				<option value="00011809">Gaelic</option>
				<option value="00000437">Georgian</option>
				<option value="00020437">Georgian (Ergonomic)</option>
				<option value="00010437">Georgian (QWERTY)</option>
				<option value="00000407">German</option>
				<option value="00010407">German (IBM)</option>
				<option value="00000408">Greek</option>
				<option value="00010408">Greek (220)</option>
				<option value="00030408">Greek (220) Latin</option>
				<option value="00020408">Greek (319)</option>
				<option value="00040408">Greek (319) Latin</option>
				<option value="00050409">Greek Latin</option>
				<option value="00060408">Greek Polytonic</option>
				<option value="0000046f">Greenlandic</option>
				<option value="00000447">Gujarati</option>
				<option value="00000468">Hausa</option>
				<option value="0000040d">Hebrew</option>
				<option value="00010439">Hindi Traditional</option>
				<option value="0000040e">Hungarian</option>
				<option value="0001040e">Hungarian 101-key</option>
				<option value="0000040f">Icelandic</option>
				<option value="00000470">Igbo</option>
				<option value="0000085d">Inuktitut - Latin</option>
				<option value="0001045d">Inuktitut - Naqittaut</option>
				<option value="00001809">Irish</option>
				<option value="00000410">Italian</option>
				<option value="00010410">Italian (142)</option>
				<option value="00000411">Japanese</option>
				<option value="0000044b">Kannada</option>
				<option value="0000043f">Kazakh</option>
				<option value="00000453">Khmer</option>
				<option value="00000412">Korean</option>
				<option value="00000440">Kyrgyz Cyrillic</option>
				<option value="00000454">Lao</option>
				<option value="0000080a">Latin American</option>
				<option value="00000426">Latvian</option>
				<option value="00010426">Latvian (QWERTY)</option>
				<option value="00010427">Lithuanian</option>
				<option value="00000427">Lithuanian IBM</option>
				<option value="00020427">Lithuanian New</option>
				<option value="0000046e">Luxembourgish</option>
				<option value="0000042f">Macedonian (FYRO)</option>
				<option value="0001042f">Macedonian (FYRO) - Standard</option>
				<option value="0000044c">Malayalam</option>
				<option value="0000043a">Maltese 47-Key</option>
				<option value="0001043a">Maltese 48-key</option>
				<option value="00000481">Maori</option>
				<option value="0000044e">Marathi</option>
				<option value="00000850">Mongolian (Mongolian Script)</option>
				<option value="00000450">Mongolian Cyrillic</option>
				<option value="00000461">Nepali</option>
				<option value="00000414">Norwegian</option>
				<option value="0000043b">Norwegian with Sami</option>
				<option value="00000448">Odia</option>
				<option value="00000463">Pashto (Afghanistan)</option>
				<option value="00000429">Persian</option>
				<option value="00010415">Polish (214)</option>
				<option value="00000415">Polish (Programmers)</option>
				<option value="00000816">Portuguese</option>
				<option value="00000416">Portuguese (Brazilian ABNT)</option>
				<option value="00010416">Portuguese (Brazilian ABNT2)</option>
				<option value="00000446">Punjabi</option>
				<option value="00000418">Romanian (Legacy)</option>
				<option value="00020418">Romanian (Programmers)</option>
				<option value="00010418">Romanian (Standard)</option>
				<option value="00000419">Russian</option>
				<option value="00010419">Russian (Typewriter)</option>
				<option value="0002083b">Sami Extended Finland-Sweden</option>
				<option value="0001043b">Sami Extended Norway</option>
				<option value="00000c1a">Serbian (Cyrillic)</option>
				<option value="0000081a">Serbian (Latin)</option>
				<option value="0000046c">Sesotho sa Leboa</option>
				<option value="00000432">Setswana</option>
				<option value="0000045b">Sinhala</option>
				<option value="0001045b">Sinhala - wij 9</option>
				<option value="0000041b">Slovak</option>
				<option value="0001041b">Slovak (QWERTY)</option>
				<option value="00000424">Slovenian</option>
				<option value="0001042e">Sorbian Extended</option>
				<option value="0002042e">Sorbian Standard</option>
				<option value="0000042e">Sorbian Standard (Legacy)</option>
				<option value="0000040a">Spanish</option>
				<option value="0001040a">Spanish Variation</option>
				<option value="0000041d">Swedish</option>
				<option value="0000083b">Swedish with Sami</option>
				<option value="0000100c">Swiss French</option>
				<option value="00000807">Swiss German</option>
				<option value="0000045a">Syriac</option>
				<option value="0001045a">Syriac Phonetic</option>
				<option value="00000428">Tajik</option>
				<option value="00000449">Tamil</option>
				<option value="00000444">Tatar</option>
				<option value="0000044a">Telugu</option>
				<option value="0000041e">Thai Kedmanee</option>
				<option value="0002041e">Thai Kedmanee (non-ShiftLock)</option>
				<option value="0001041e">Thai Pattachote</option>
				<option value="0003041e">Thai Pattachote (non-ShiftLock)</option>
				<option value="00000451">Tibetan (PRC)</option>
				<option value="0001041f">Turkish F</option>
				<option value="0000041f">Turkish Q</option>
				<option value="00000442">Turkmen</option>
				<option value="00000480">Uyghur (Legacy)</option>
				<option value="00000422">Ukrainian</option>
				<option value="00020422">Ukrainian (Enhanced)</option>
				<option value="00000809">United Kingdom</option>
				<option value="00000452">United Kingdom Extended</option>
				<option value="00010409">United States - Dvorak</option>
				<option value="00020409">United States - International</option>
				<option value="00030409">United States - Dvorak for left hand</option>
				<option value="00040409">United States - Dvorak for right hand</option>
				<option value="00000409">United States - English</option>
				<option value="00000420">Urdu</option>
				<option value="00010480">Uyghur</option>
				<option value="00000843">Uzbek Cyrillic</option>
				<option value="0000042a">Vietnamese</option>
				<option value="00000488">Wolof</option>
				<option value="00000485">Yakut</option>
				<option value="0000046a">Yoruba</option>
				
			</SELECT>
			</p>

			<input type=hidden NAME="UserLocale" class=WideEdit />
			<input type=hidden NAME="KeyboardLocale" class=WideEdit />

        ]]>

		</Body>

	</Pane>


	<Pane id="TimeZone">
		<Condition><![CDATA[   UCase(Property("SkipTimeZone"))<>"YES" and Property("DeploymentType")<>"REPLACE" and Property("DeploymentType")<>"CUSTOM" and Property("DeploymentType") <> "StateRestore"]]> </Condition>
		<Initialization><![CDATA[ TimeZone_Initialization ]]> </Initialization>
		<Validation><![CDATA[  TimeZoneName.Value <> "" and TimeZone.Value <> "" ]]></Validation>

		<Body>
		<![CDATA[

           <!-- Use the H1 Style for titles at the top of the page -->
           <H1>Set the Time Zone<H1>

           <select id=TimeZoneList size=15 language=VBScript onchange="SetTimeZoneValue" class=wideedit>

           <!--
           The following is a static table of Time Zones supported by Windows XP/2003 and Windows Vista
           TimeZone Format:
               <option value="TimeZoneNumber;TimeZoneName[;TimeZoneName_Alternate][;TimeZoneDescription_Alternate]">TimeZoneDescription</option>
           Where:
               TimeZoneNumber - The Time Zone number used in Windows XP/2003 (Whistler) Unattend.txt files. [GuiUnattended] TimeZone
               TimeZoneName - The Time Zone Name used in Windows Vista (Longhorn) unattend.xml files. <TimeZone> entries
               TimeZoneName_Alternate - This is the alternate Name used in Windows XP documentation. (Used to Match Time Zone only).
               TimeZoneDescription_Alternate - This is the Alternate Description used in Windows XP Documentation. (Used to Match Time Zone only).
               TimeZoneDescription - This is the value displayed in the dialog box.
           -->

                <option value="90;Greenwich Standard Time">(UTC) Casablanca, Monrovia</option>
                <option value="85;UTC Standard Time">(UTC) Greenwich Mean Time : Dublin, Edinburgh, Lisbon, London</option>
                <option value="110;W. Europe Standard Time">(UTC+01:00) Amsterdam, Berlin, Bern, Rome, Stockholm, Vienna</option>
                <option value="95;Central Europe Standard Time">(UTC+01:00) Belgrade, Bratislava, Budapest, Ljubljana, Prague</option>
                <option value="105;Romance Standard Time">(UTC+01:00) Brussels, Copenhagen, Madrid, Paris</option>
                <option value="100;Central European Standard Time">(UTC+01:00) Sarajevo, Skopje, Warsaw, Zagreb</option>
                <option value="113;W. Central Africa Standard Time">(UTC+01:00) West Central Africa</option>
                <option value="130;GTB Standard Time">(UTC+02:00) Athens, Bucharest</option>
                <option value="115;E. Europe Standard Time">(UTC+02:00) Nicosia</option>
                <option value="120;Egypt Standard Time">(UTC+02:00) Cairo</option>
                <option value="140;South Africa Standard Time">(UTC+02:00) Harare, Pretoria</option>
                <option value="125;FLE Standard Time;(UTC+02:00) Helsinki, Kyiv, Riga, Sofia, Tallinn, Vilnius">(UTC+02:00) Helsinki, Kiev, Riga, Sofia, Tallinn, Vilnius</option>
                <option value="135;Israel Standard Time">(UTC+02:00) Jerusalem</option>
                <option value="000;Syria Standard Time">(UTC+02:00) Damascus</option>
                <option value="000;Turkey Standard Time">(UTC+02:00) Istanbul</option>
                <option value="000;Kaliningrad Standard Time">(UTC+03:00) Kaliningrad, Minsk</option>
                <option value="158;Arabic Standard Time">(UTC+03:00) Baghdad</option>
                <option value="150;Arab Standard Time">(UTC+03:00) Kuwait, Riyadh</option>
                <option value="145;Russian Standard Time">(UTC+03:00) Moscow, St. Petersburg, Volgograd</option>
                <option value="155;E. Africa Standard Time">(UTC+03:00) Nairobi</option>
                <option value="160;Iran Standard Time">(UTC+03:30) Tehran</option>
                <option value="165;Arabian Standard Time">(UTC+04:00) Abu Dhabi, Muscat</option>
                <option value="170;Caucasus Standard Time">(UTC+04:00) Baku, Tbilisi, Yerevan</option>
                <option value="175;Afghanistan Standard Time;Islamic Republic of Afghanistan Standard Time">(UTC+04:30) Kabul</option>
                <option value="180;Ekaterinburg Standard Time">(UTC+05:00) Ekaterinburg</option>
                <option value="185;West Asia Standard Time">(UTC+05:00) Islamabad, Karachi, Tashkent</option>
                <option value="190;India Standard Time">(UTC+05:30) Chennai, Kolkata, Mumbai, New Delhi</option>
                <option value="193;Nepal Standard Time">(UTC+05:45) Kathmandu</option>
                <option value="201;N. Central Asia Standard Time">(UTC+06:00) Novosibirsk</option>
                <option value="195;Central Asia Standard Time">(UTC+06:00) Astana, Dhaka</option>
                <option value="200;Sri Lanka Standard Time">(UTC+06:00) Sri Jayawardenepura</option>
                <option value="203;Myanmar Standard Time">(UTC+06:30) Yangon (Rangoon)</option>
                <option value="205;SE Asia Standard Time;S.E. Asia Standard Time">(UTC+07:00) Bangkok, Hanoi, Jakarta</option>
                <option value="207;North Asia Standard Time">(UTC+07:00) Krasnoyarsk</option>
                <option value="210;China Standard Time">(UTC+08:00) Beijing, Chongqing, Hong Kong SAR, Urumqi</option>
                <option value="227;North Asia East Standard Time;(UTC+08:00) Irkutsk, Ulan Bator">(UTC+08:00) Irkutsk, Ulaanbaatar</option>
                <option value="215;Singapore Standard Time">(UTC+08:00) Kuala Lumpur, Singapore</option>
                <option value="225;W. Australia Standard Time">(UTC+08:00) Perth</option>
                <option value="220;Taipei Standard Time">(UTC+08:00) Taipei</option>
                <option value="235;Tokyo Standard Time">(UTC+09:00) Osaka, Sapporo, Tokyo</option>
                <option value="230;Korea Standard Time">(UTC+09:00) Seoul</option>
                <option value="240;Yakutsk Standard Time">(UTC+09:00) Yakutsk</option>
                <option value="250;Cen. Australia Standard Time">(UTC+09:30) Adelaide</option>
                <option value="245;AUS Central Standard Time;A.U.S. Central Standard Time">(UTC+09:30) Darwin</option>
                <option value="260;E. Australia Standard Time">(UTC+10:00) Brisbane</option>
                <option value="255;AUS Eastern Standard Time;A.U.S. Eastern Standard Time">(UTC+10:00) Canberra, Melbourne, Sydney</option>
                <option value="275;West Pacific Standard Time">(UTC+10:00) Guam, Port Moresby</option>
                <option value="265;Tasmania Standard Time">(UTC+10:00) Hobart</option>
                <option value="270;Vladivostok Standard Time">(UTC+10:00) Vladivostok</option>
                <option value="280;Central Pacific Standard Time">(UTC+11:00) Solomon Is., New Caledonia</option>
                <option value="290;New Zealand Standard Time">(UTC+12:00) Auckland, Wellington</option>
                <option value="285;Kamchatka Standard Time">(UTC+12:00) Petropavlovsk-Kamchatsky - Old</option>
                <option value="000;Magadan Standard Time">(UTC+12:00) Magadan</option>
                <option value="300;Tonga Standard Time">(UTC+13:00) Nuku'alofa</option>
                <option value="80;Azores Standard Time">(UTC-01:00) Azores</option>
                <option value="83;Cape Verde Standard Time">(UTC-01:00) Cape Verde Islands</option>
                <option value="75;Mid-Atlantic Standard Time">(UTC-02:00) Mid-Atlantic</option>
                <option value="000;Bahia Standard Time">(UTC-03:00) Salvador</option>
                <option value="65;E. South America Standard Time">(UTC-03:00) Brasilia</option>
                <option value="70;SA Eastern Standard Time;S.A. Eastern Standard Time">(UTC-03:00) Buenos Aires, Georgetown</option>
                <option value="73;Greenland Standard Time">(UTC-03:00) Greenland</option>
                <option value="60;Newfoundland Standard Time;Newfoundland and Labrador Standard Time">(UTC-03:30) Newfoundland and Labrador</option>
                <option value="50;Atlantic Standard Time">(UTC-04:00) Atlantic Time (Canada)</option>
                <option value="55;SA Western Standard Time;S.A. Western Standard Time">(UTC-04:00) Caracas, La Paz</option>
                <option value="56;Pacific SA Standard Time;Pacific S.A. Standard Time">(UTC-04:00) Santiago</option>
                <option value="45;SA Pacific Standard Time;S.A. Pacific Standard Time">(UTC-05:00) Bogota, Lima, Quito</option>
                <option value="35;Eastern Standard Time">(UTC-05:00) Eastern Time (US and Canada)</option>
                <option value="40;US Eastern Standard Time;U.S. Eastern Standard Time">(UTC-05:00) Indiana (East)</option>
                <option value="33;Central America Standard Time">(UTC-06:00) Central America</option>
                <option value="20;Central Standard Time">(UTC-06:00) Central Time (US and Canada)</option>
                <option value="30;Mexico Standard Time">(UTC-06:00) Guadalajara, Mexico City, Monterrey</option>
                <option value="25;Canada Central Standard Time">(UTC-06:00) Saskatchewan</option>
                <option value="15;US Mountain Standard Time;U.S. Mountain Standard Time">(UTC-07:00) Arizona</option>
                <option value="13;Mexico Standard Time 2">(UTC-07:00) Chihuahua, La Paz, Mazatlan</option>
                <option value="10;Mountain Standard Time">(UTC-07:00) Mountain Time (US and Canada)</option>
                <option value="4;Pacific Standard Time">(UTC-08:00) Pacific Time (US and Canada); Tijuana</option>
                <option value="3;Alaskan Standard Time">(UTC-09:00) Alaska</option>
                <option value="2;Hawaiian Standard Time">(UTC-10:00) Hawaii</option>
                <option value="1;Samoa Standard Time">(UTC-11:00) Midway Island, Samoa</option>
                <option value="0;Dateline Standard Time">(UTC-12:00) International Date Line West</option>

           </select>

           <input type=hidden Name=TimeZone /> <!-- XP Style TimeZone PST = 004 -->
           <input type=hidden Name=TimeZoneName />  <!-- Vista Style TimeZone PST = "Pacific Standard Time" -->

        ]]>

		</Body>

	</Pane>


	<Pane id="ApplicationSelection">
		<Condition><![CDATA[UCase(Property("DeploymentType"))<>"REPLACE" ]]></Condition>
		<Condition><![CDATA[UCase(Property("SkipAppsOnUpgrade"))<>"YES" or ucase(Property("DeploymentType"))<>"UPGRADE" ]]></Condition>
		<Condition><![CDATA[UCase(Property("SkipApplications"))<>"YES" ]]></Condition>
		<Condition><![CDATA[ IsThereAtLeastOneApplicationPresent ]]></Condition>
	  <Body>
		<![CDATA[
      <H1>Select one or more applications to install.</H1>
	  
	  
		<div class=TreeList id=AppListBox style="height: expression( GetDynamicListBoxSize(this) );">

			<!-- List goes here -->

		</div>

		<input type=hidden Name=Applications disabled value="" />
		<input type=hidden Name=Applications disabled value="" />

			]]>
		</Body>
		<Initialization><![CDATA[InitializeApplicationList]]></Initialization>
	</Pane>


	<Pane id="AdministratorPassword">
		<Condition><![CDATA[UCase(Property("SkipAdminPassword"))<>"YES" and UCase(Property("DeploymentType"))<>"REPLACE"]]></Condition>
		<Body>
		<![CDATA[
      <H1>Administrator Password.</H1>


<p>This password will be used for logging onto the computer after a restart.</p>
Administrator Password: <br/>
<input type=password id="Password1" name="AdminPassword"  size=20 language=vbscript onchange=ValidatePassword onpropertychange=ValidatePassword>
<label class=ErrMsg For=Password1>* Required (MISSING)</label></br>

Please confirm Administrator Password: <br/>
<input type=password id="Password2" size=20 language=vbscript onchange=ValidatePassword onpropertychange=ValidatePassword>
<label id=NonMatchPassword class=ErrMsg>ERROR! Passwords do not match!</label></br>
</p>

			]]>
		</Body>
		<Initialization><![CDATA[ Password2.Value = Password1.Value ]]></Initialization>
		<Validation><![CDATA[ValidatePassword]]></Validation>
	</Pane>


	<Pane id="CaptureImage">
		<Condition><![CDATA[Ucase(Property("SkipCapture"))<>"YES" and Property("DeploymentType") <> "REFRESH" and Property("JoinDomain") = "" and Property("DeploymentType") <> "REPLACE"]]></Condition>
		<Condition><![CDATA[Property("DeploymentType") <> "UPGRADE" and  FindTaskSequenceStep("//step[@name='Create WIM']", "ZTIBackup.wsf" ) ]]></Condition>
		<Body>
		<![CDATA[
	<H1>Specify whether to capture an image.</H1>
	<table>

	<tr>
		<td>
			<input type=radio name="DoCapture" id="CaptureRadio1" Value="YES" language=vbscript onclick=ValidateCapture  AccessKey=A>
		</td>
		<td>
			<Label class="Larger" for=CaptureRadio1 language=vbscript >C<u class=larger>a</u>pture an image of this reference computer.</Label>
		</td>
	</tr>
	<tr>
		<td></td>
		<td>
			<div>Specify the UNC path where the image should be stored and the file name to use.</div>
			<br>
			<div><u>L</u>ocation:  <label class=ErrMsg for=ComputerBackupLocation>* Required (MISSING)</label></div>
                        <div><label class=ErrMsg id="InvalidCaptureLocation">ERROR: Unable to connect to UNC path.</label></div>
			<input type=text name="ComputerBackupLocation" id="ComputerBackupLocation" size=65 disabled language=vbscript AccessKey=L>
			<br>
			<div>File name:  <label class=ErrMsg for=BackupFile>* Required (MISSING)</label></div>
			<input type=text name="BackupFile" id="BackupFile" size=65 disabled language=vbscript onpropertychange=ValidateCapture >

		</td>
	</tr>

	<tr><td colspan=2>&nbsp;</td></tr>

	<tr>
		<td>
			<input type=radio name="DoCapture" id="CaptureRadio2" value="PREPARE" language=vbscript onclick=ValidateCapture  AccessKey=P>
		</td>
		<td>
			<Label class="Larger" for=CaptureRadio2 language=vbscript ><u class=larger>P</u>repare to capture the machine</Label>
		</td>
	</tr>
	<tr>
		<td></td>
		<td>
			<div>Copy the needed Sysprep files to the proper location, but do not perform the actual capture or initiate Sysprep.</div>
		</td>
	</tr>

	<tr><td colspan=2>&nbsp;</td></tr>

	<tr>
		<td>
			<input type=radio name="DoCapture" id="CaptureRadio3" checked value="NO" language=vbscript onclick=ValidateCapture  AccessKey=O>
		</td>
		<td>
			<Label class="Larger" for=CaptureRadio3 language=vbscript >Do n<u class=larger>o</u>t capture an image of this computer.</Label>
		</td>
	</tr>
	<tr>
		<td></td>
		<td>
			<div>This is a normal deployment, so an image does not need to be captured.</div>
		</td>
	</tr>

	</table>
		]]>
		</Body>
		<Validation><![CDATA[ValidateCapture]]></Validation>
		<Validation><![CDATA[ValidateCaptureLocation]]></Validation>
		<Initialization><![CDATA[InitializeCapture]]></Initialization>
	</Pane>

	<Pane id="BitLocker">
		<Condition><![CDATA[Property("DeploymentType")<>"REPLACE" and Property("DeploymentType")<>"CUSTOM" and UCase(Property("SkipBitLocker")) <> "YES" and UCase(Property("DoCapture")) <> "YES" and UCase(Property("DoCapture")) <> "PREPARE" ]]></Condition>
		<Condition><![CDATA[ Left(Property("ImageBuild"), 1) = "6" and oUtility.IsHighEndSKUEx( oEnvironment.Item("ImageFlags") ) ]]></Condition>
		<Body>
  <![CDATA[

	<H1>Specify the BitLocker configuration.</H1>

	<p>BitLocker can be enabled to provide an additional level of data security for this computer.</p>

	<table>

	<tr>
		<td>
			<input type=radio name="BdeGroup" id="BDERadio1" checked language=vbscript onclick=ValidateBDE  AccessKey=A >
		</td>
		<td>
			<Label class="Larger" for=BDERadio1 language=vbscript ><u class=larger>D</u>o not enable BitLocker for this computer.</Label>
		</td>
	</tr>

	<tr><td colspan=2>&nbsp;</td></tr>

	<tr>
		<td>
			<input type=radio name="BdeGroup" id="BDERadio2" language=vbscript onclick=ValidateBDE  AccessKey=T >
		</td>
		<td>
			<Label class="Larger" for=BDERadio2 language=vbscript >Enable BitLocker.</Label>
		</td>
	</tr>
	<tr>
		<td></td>
		<td>
			<table>
			<tr>
				<td>
					<input type=radio name="BdeMode" id="BdeModeRadio1" checked language=vbscript onclick=ValidateBDE  AccessKey=M >
				</td>
				<td>
					<Label language=vbscript for="BdeModeRadio1" >Enable BitLocker using TP<u>M</u> only.</Label>
				</td>
			</tr>
			<tr>
				<td>
					<input type=radio name="BdeMode" id="BdeModeRadio4" language=vbscript onclick=ValidateBDE  AccessKey=P >
				</td>
				<td>
					<Label for=BdeModeRadio4 language=vbscript >Enable BitLocker using TPM and Pin.</Label>
				</td>
				<td>
				<input type=text size=20 maxlength=20 name="BdePin" id="BdePin" language=vbscript onclick=ValidateBDE  AccessKey=P >
				</td>
				</td>
			</tr>
			<tr>
				<td>
					<input type=radio name="BdeMode" id="BdeModeRadio2" language=vbscript onclick=ValidateBDE  AccessKey=S >
				</td>
				<td>
					<Label language=vbscript for=BdeModeRadio2>Enable BitLocker using TPM and a <u>s</u>tartup key.</Label>
				</td>
				<td>
					<select name="BdeModeSelect1" onblur=ValidateBDE>
						<option>First Available</option>
						<option value="A:">A:</option>
						<option value="B:">B:</option>
						<option value="C:">C:</option>
						<option value="D:">D:</option>
						<option value="E:">E:</option>
						<option value="F:">F:</option>
						<option value="G:">G:</option>
						<option value="H:">H:</option>
						<option value="I:">I:</option>
						<option value="J:">J:</option>
						<option value="K:">K:</option>
						<option value="L:">L:</option>
						<option value="M:">M:</option>
						<option value="N:">N:</option>
						<option value="O:">O:</option>
						<option value="P:">P:</option>
						<option value="Q:">Q:</option>
						<option value="R:">R:</option>
						<option value="S:">S:</option>
						<option value="T:">T:</option>
						<option value="U:">U:</option>
						<option value="V:">V:</option>
						<option value="W:">W:</option>
						<option value="X:">X:</option>
						<option value="Y:">Y:</option>
						<option value="Z:">Z:</option>
					</select>
				</td>

			</tr>

			<tr>
				<td>
					<input type=radio name="BdeMode" id="BdeModeRadio3" language=vbscript onclick=ValidateBDE  AccessKey=P >
				</td>
				<td>
					<Label for=BdeModeRadio3 language=vbscript >Enable BitLocker using only an External Startup Key.</Label>
				</td>
				<td>
					<select name="BdeModeSelect2" onblur=ValidateBDE>
						<option>First Available</option>
						<option value="A:">A:</option>
						<option value="B:">B:</option>
						<option value="C:">C:</option>
						<option value="D:">D:</option>
						<option value="E:">E:</option>
						<option value="F:">F:</option>
						<option value="G:">G:</option>
						<option value="H:">H:</option>
						<option value="I:">I:</option>
						<option value="J:">J:</option>
						<option value="K:">K:</option>
						<option value="L:">L:</option>
						<option value="M:">M:</option>
						<option value="N:">N:</option>
						<option value="O:">O:</option>
						<option value="P:">P:</option>
						<option value="Q:">Q:</option>
						<option value="R:">R:</option>
						<option value="S:">S:</option>
						<option value="T:">T:</option>
						<option value="U:">U:</option>
						<option value="V:">V:</option>
						<option value="W:">W:</option>
						<option value="X:">X:</option>
						<option value="Y:">Y:</option>
						<option value="Z:">Z:</option>
					</select>
				</td>
				</td>
			</tr>
			</table>

		</td>
	</tr>

	<!--tr><td>&nbsp;</td></tr -->

	<tr>
		<td>&nbsp;</td>
		<td>
			<Label language=vbscript >Choose where to store the Recovery Key.</Label>
		</td>
	</tr>
	<tr>
		<td>&nbsp;</td>
		<td>
			<input type=radio name="AD" id="ADButton1" language=vbscript onclick=ValidateBDE  AccessKey=M > <label for="ADButton1">In Active Directory</label>
		</td>
	</tr>
		<tr>
		<td>&nbsp;</td>
		<td>
			<input type=radio name="AD" id="ADButton2" checked language=vbscript onclick=ValidateBDE  AccessKey=M > <label for="ADButton2">Do not create a recovery key. (Not recommended)</label>
		</td>
	</tr>

	<!--tr><td>&nbsp;</td></tr -->

		<tr>
		<td>&nbsp;</td>
		<td></br>
			<input type=checkbox name="WaitForEncryption" id=waitfore language=vbscript onclick=ValidateBDE  AccessKey=M > <label for="waitfore">Wait for Bitlocker Encryption to complete on all drives before continuing.</label>
		</td>
	</tr>


	</table>

	<input type=hidden id="BdeInstall" name="BdeInstall">
	<input type=hidden id="OSDBitLockerStartupKeyDrive" name="OSDBitLockerStartupKeyDrive">
	<input type=hidden id="OSDBitLockerWaitForEncryption" name="OSDBitLockerWaitForEncryption">
	<input type=hidden id="BdeRecoveryKey" name="BdeRecoveryKey">
	<input type=hidden id="BdeInstallSuppress" name="BdeInstallSuppress">


			]]>
		</Body>
		<Initialization><![CDATA[InitializeBDE]]></Initialization>
		<Initialization><![CDATA[ValidateBDE]]></Initialization>
		<Validation><![CDATA[ValidateBDE]]></Validation>

	</Pane>

	<Pane id="Credentials">
		<Condition><![CDATA[((UserID_isDirty = TRUE or Property("UserID")="") or (Property("UserPassword")="") or (Property("UserDomain") = Property("OSDComputerName"))) and Property("DeploymentMethod") <> "MEDIA"]]></Condition>
		<Body>
		<![CDATA[
	<H1>Specify credentials for connecting to network shares.</H1>

<div class="larger">Credentials:<div><label class=ErrMsg id=InvalidCredentials>* Invalid credentials</label>
<table>
	<tr>
		<td width="100px"><u >U</u>ser Name:</td>
		<td>
			<input type=text id=username name="UserID" size=37 language=vbscript onpropertychange=ValidateCredentials AccessKey=U>
			<label class=ErrMsg for=username>* Required (MISSING)</label>
		</td>
	</tr>
	<tr>
		<td><u>P</u>assword:</td>
		<td>
			<input type=password id=userpassword name="UserPassword" size=37 language=vbscript onpropertychange=ValidateCredentials AccessKey=P>
			<label class=ErrMsg for=userpassword>* Required (MISSING)</label>
		</td>
	</tr>
	<tr>
		<td><u>D</u>omain:</td>
		<td>
			<input type=text id=userdomain name="UserDomain" size=37 language=vbscript onpropertychange=ValidateCredentials AccessKey=D>
			<label class=ErrMsg for=userdomain>* Required (MISSING)</label>
		</td>
	</tr>
</table>

			]]>
		</Body>
		<Initialization><![CDATA[ If Property("UserDomain") = Property("ComputerName") then userdomain.Value = "" ]]></Initialization>
		<Initialization><![CDATA[ ParseAllWarningLabelsEx userdomain, username ]]></Initialization>
		<Validation><![CDATA[ValidateCredentialsEx]]></Validation>
	</Pane>


	<Pane id="Ready">
		<Condition><![CDATA[ucase(Property("SkipSummary")) <> "YES"]]></Condition>
		<ButtonNext>
			<Label><![CDATA[<button accesskey=G id=buttonNext language=vbscript onclick=ButtonNextClick>Be<U>g</U>in</button>]]></Label>
		</ButtonNext>
		<Body>
	<![CDATA[
		<H1>Ready to begin.</H1>
		<p>Using the information you provided, the deployment can now begin.</p>

		<p>
		 <input id=MoreInfo src=plusicon.gif type=image onclick="javascript:HideUnHideCmdWindow(optionalWindow1);" />
		 <label onclick="javascript:MoreInfo.click();" >Details ...</label></br>
		 <span id=optionalWindow1 style="display=none;" class=LightColoredBox>Details Here!</span>
		</p>

	]]>
		</Body>
		<Initialization><![CDATA[PrepareFinalScreen]]></Initialization>
	</Pane>

</Wizard>
